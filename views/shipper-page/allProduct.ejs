<!-- index.ejs -->
<!DOCTYPE html>
<html>
<head>
    <title>Products</title>
</head>
<body>
    <h1>Products</h1>

    <div>
        <% products.forEach(product => { %>
            <div>
                <h2><%= product.product_Name %></h2>
                <p>Price: <%= product.product_Price %></p>
                <button onclick="addToCart('<%= product._id %>')">Add to Cart</button>
            </div>
        <% }) %>
        <button onclick="viewCart()">View Cart</button>
    </div>

    <script>
        function addToCart(productId) {
            // Retrieve existing cart items from localStorage or create an empty array
            const cartProduct = JSON.parse(localStorage.getItem('cartProduct')) || [];

            // Check if the product is already in the cart
            const existingItemIndex = cartProduct.findIndex(item => item.productId === productId);

            if (existingItemIndex !== -1) {
                // If the product is already in the cart, increase the quantity
                cartProduct[existingItemIndex].quantity += 1;
            } else {
                // If the product is not in the cart, add it with a quantity of 1
                cartProduct.push({ productId, quantity: 1 });
            }

            // Update the cart items in localStorage
            localStorage.setItem('cartProduct', JSON.stringify(cartProduct));

            // Show a confirmation message to the user
            alert('Product added to cart!');
        }

        function viewCart() {
            // Redirect the user to the cart page
            window.location.href = '/api/product/cart';
        }
    </script>
</body>
</html>
